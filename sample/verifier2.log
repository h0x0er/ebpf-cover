libbpf: prog 'handle_egress': BPF program load failed: Invalid argument
libbpf: prog 'handle_egress': -- BEGIN PROG LOAD LOG --
0: R1=ctx() R10=fp0
; struct event *eve = bpf_ringbuf_reserve(&events, sizeof(struct event), 0); @ main.bpf.c:24
0: (18) r1 = 0xffff8f0c827fe600       ; R1_w=map_ptr(map=events,ks=0,vs=0)
2: (b7) r2 = 12                       ; R2_w=12
3: (b7) r3 = 0                        ; R3_w=0
4: (85) call bpf_ringbuf_reserve#131          ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=12) refs=2
5: (bf) r6 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=12) R6_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=12) refs=2
6: (b7) r7 = 1                        ; R7_w=1 refs=2
; if (!eve) { @ main.bpf.c:26
7: (15) if r6 == 0x0 goto pc+30       ; R6_w=ringbuf_mem(ref_obj_id=2,sz=12) refs=2
; struct task_struct *tsk = (struct task_struct *)bpf_get_current_task(); @ main.bpf.c:30
8: (85) call bpf_get_current_task#35          ; R0=scalar() refs=2
9: (bf) r8 = r0                       ; R0=scalar(id=3) R8_w=scalar(id=3) refs=2
10: (b7) r9 = 2404                    ; R9_w=2404 refs=2
11: (bf) r3 = r8                      ; R3_w=scalar(id=3) R8_w=scalar(id=3) refs=2
12: (0f) r3 += r9                     ; R3_w=scalar(id=3+2404) R9_w=2404 refs=2
13: (bf) r1 = r10                     ; R1_w=fp0 R10=fp0 refs=2
;  @ main.bpf.c:0
14: (07) r1 += -16                    ; R1_w=fp-16 refs=2
15: (b7) r7 = 4                       ; R7_w=4 refs=2
; eve->pid = BPF_CORE_READ(tsk, tgid); @ main.bpf.c:31
16: (b7) r2 = 4                       ; R2_w=4 refs=2
17: (85) call bpf_probe_read_kernel#113       ; R0_w=scalar() fp-16=????mmmm refs=2
18: (61) r1 = *(u32 *)(r10 -16)       ; R1_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff)) R10=fp0 fp-16=????mmmm refs=2
19: (63) *(u32 *)(r6 +4) = r1         ; R1_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff)) R6=ringbuf_mem(ref_obj_id=2,sz=12) refs=2
20: (b7) r1 = 2416                    ; R1_w=2416 refs=2
21: (0f) r8 += r1                     ; R1_w=2416 R8_w=scalar(id=3+2416) refs=2
22: (bf) r1 = r10                     ; R1_w=fp0 R10=fp0 refs=2
;  @ main.bpf.c:0
23: (07) r1 += -16                    ; R1_w=fp-16 refs=2
; eve->ppid = BPF_CORE_READ(tsk, real_parent, tgid); @ main.bpf.c:32
24: (b7) r2 = 8                       ; R2_w=8 refs=2
25: (bf) r3 = r8                      ; R3_w=scalar(id=4) R8_w=scalar(id=4) refs=2
26: (85) call bpf_probe_read_kernel#113       ; R0=scalar() fp-16=mmmmmmmm refs=2
27: (79) r3 = *(u64 *)(r10 -16)       ; R3_w=scalar() R10=fp0 fp-16=mmmmmmmm refs=2
28: (0f) r3 += r9                     ; R3_w=scalar() R9=2404 refs=2
29: (bf) r1 = r10                     ; R1_w=fp0 R10=fp0 refs=2
;  @ main.bpf.c:0
30: (07) r1 += -4                     ; R1_w=fp-4 refs=2
; eve->ppid = BPF_CORE_READ(tsk, real_parent, tgid); @ main.bpf.c:32
31: (b7) r2 = 4                       ; R2_w=4 refs=2
32: (85) call bpf_probe_read_kernel#113       ; R0_w=scalar() fp-8=mmmm???? refs=2
33: (61) r1 = *(u32 *)(r10 -4)        ; R1_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff)) R10=fp0 fp-8=mmmm???? refs=2
34: (63) *(u32 *)(r6 +8) = r1         ; R1_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff)) R6=ringbuf_mem(ref_obj_id=2,sz=12) refs=2
; bpf_ringbuf_submit(eve, 0); @ main.bpf.c:34
35: (bf) r1 = r6                      ; R1_w=ringbuf_mem(ref_obj_id=2,sz=12) R6=ringbuf_mem(ref_obj_id=2,sz=12) refs=2
36: (b7) r2 = 0                       ; R2_w=0 refs=2
37: (85) call bpf_ringbuf_submit#132          ;
; } @ main.bpf.c:38
38: (bf) r0 = r7                      ; R0_w=4 R7=4
39: (95) exit
At program exit the register R0 has smin=4 smax=4 should have been in [0, 3]
processed 39 insns (limit 1000000) max_states_per_insn 0 total_states 3 peak_states 3 mark_read 2
-- END PROG LOAD LOG --
libbpf: prog 'handle_egress': failed to load: -22
libbpf: failed to load object 'bpf/main.bpf.o'
Error: failed to load object file